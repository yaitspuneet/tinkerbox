resources:
  lb-01a:
    type: Compute.LoadBalancer
    properties:
      name: lb-01a
      publicdns: selfies.wwko2018.com
      network: '${Network_1.name}'
      instances: '${lychee.id}'
      internetFacing: true
      routes:
        - protocol: HTTP
          port: '80'
          instanceProtocol: HTTP
          instancePort: '80'
  lychee:
    type: Compute
    properties:
      count: 1
      flavor: t2.micro
      image: ami-055dd07d
      cloudConfig: |
        #cloud-config
          users:
            - name: grant
              ssh-authorized-keys:
                - ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQCUZtLEIQCZ1Oi9LQxSrDBswWO3FV64QVI9AfiTHcmyzvEYtFJHMSWIvZr3GAoE9CCohXU7KY9TmDTr9HL5hmZn/i8yuvQbC3GuFHVsW5J9FtdoQEPWHyIlg6FaURNFz9oKJ11bO/lvLWx9gu4tP1kfJgFW6CVXWjW7CSQmcUqjH2Vd8Bsj0e7VZBFVgI4Ff06qO1L0kLQRsElTwb7bWDgPpl/M78eK1cWFesJZDNg4PUdexEdXyYeLj7937TVqJH2GN8DthsSNXv7DZZ+s+4vYY/PEIl+ATg+xQzrkvWD5L1bQUcLmePIQj9cdGZ02bGD0dk7/CXhOFMsI7akucMBt root@Grants-MacBook-Pro.local
              sudo: ['ALL=(ALL) NOPASSWD:ALL']
              groups: sudo
          runcmd:
            - sudo sed -i '/s/127.0.0.1/${mysql.address}/' /var/www/html/data/config.php
      networks:
        - name: '${Network_1.name}'
  mysql:
    type: Compute
    properties:
      flavor: t2.micro
      image: ami-055dd07d
      cloudConfig: |
        #cloud-config
          users:
            - name: grant
              ssh-authorized-keys:
                - ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQCUZtLEIQCZ1Oi9LQxSrDBswWO3FV64QVI9AfiTHcmyzvEYtFJHMSWIvZr3GAoE9CCohXU7KY9TmDTr9HL5hmZn/i8yuvQbC3GuFHVsW5J9FtdoQEPWHyIlg6FaURNFz9oKJ11bO/lvLWx9gu4tP1kfJgFW6CVXWjW7CSQmcUqjH2Vd8Bsj0e7VZBFVgI4Ff06qO1L0kLQRsElTwb7bWDgPpl/M78eK1cWFesJZDNg4PUdexEdXyYeLj7937TVqJH2GN8DthsSNXv7DZZ+s+4vYY/PEIl+ATg+xQzrkvWD5L1bQUcLmePIQj9cdGZ02bGD0dk7/CXhOFMsI7akucMBt root@Grants-MacBook-Pro.local
              sudo: ['ALL=(ALL) NOPASSWD:ALL']
              groups: sudo
              
      networks:
        - name: '${Network_1.name}'
  Network_1:
    type: Compute.Network
    properties:
      name: wwko2018
      networkType: public
